#!/usr/bin/env bash
# GPT OSS Tools - Main Interface

TOOLS_DIR="/Users/cameronbrooks/gptoss-tools"

case "$1" in
    "glop"|"glob")
        shift
        "$TOOLS_DIR/glop" "$@"
        ;;
    "grep"|"search-text")
        shift
        "$TOOLS_DIR/grep" "$@"
        ;;
    "write"|"filewrite")
        shift
        "$TOOLS_DIR/filewrite" "$@"
        ;;
    "read"|"cat")
        shift
        "$TOOLS_DIR/read" "$@"
        ;;
    "search"|"index")
        shift
        "$TOOLS_DIR/search" "$@"
        ;;
    "ready"|"prepare")
        shift
        "$TOOLS_DIR/readymyfiles" "$@"
        ;;
    "status"|"info")
        echo "ü§ñ GPT OSS Tools Status"
        echo "Tools directory: $TOOLS_DIR"
        echo ""
        echo "Available tools:"
        echo "  glop       - File pattern matching"
        echo "  grep       - Text search"
        echo "  filewrite  - File creation/editing"
        echo "  read       - Smart file reading"
        echo "  search     - Content indexing"
        echo "  readymyfiles - File preparation"
        echo ""
        echo "Ollama status:"
        if command -v ollama &> /dev/null; then
            if curl -s http://localhost:11434/api/tags &> /dev/null; then
                echo "  ‚úÖ Ollama server running"
                ollama list | grep gpt-oss | head -3 || echo "  ‚ö†Ô∏è  No GPT OSS models found"
            else
                echo "  ‚ö†Ô∏è  Ollama installed but not running"
            fi
        else
            echo "  ‚ùå Ollama not installed"
        fi
        ;;
    "help"|"--help"|"-h"|"")
        echo "ü§ñ GPT OSS Tools - AI Development Toolkit"
        echo ""
        echo "Usage: gptoss <tool> [arguments]"
        echo ""
        echo "Available tools:"
        echo "  glop       - Advanced file pattern matching"
        echo "  grep       - Powerful text search"
        echo "  filewrite  - File creation and editing utilities"
        echo "  read       - Smart file reading with syntax highlighting"
        echo "  search     - Content indexing and semantic search"
        echo "  readymyfiles - File preparation for AI workflows"
        echo ""
        echo "Special commands:"
        echo "  status     - Show system status"
        echo "  help       - Show this help"
        echo ""
        echo "Examples:"
        echo "  gptoss glop '*.py' --recursive"
        echo "  gptoss grep 'function' --include='*.js'"
        echo "  gptoss search index --directory=./src"
        echo "  gptoss ready prepare-for-ai --include='*.py'"
        echo ""
        echo "For tool-specific help, run: gptoss <tool> --help"
        ;;
    *)
        echo "‚ùå Unknown tool: $1"
        echo "Run 'gptoss help' for available tools"
        exit 1
        ;;
esac
